(self.webpackChunkccm_app=self.webpackChunkccm_app||[]).push([[25],{5025:function(e,t,n){"use strict";function r(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.r(t),n(2222),n(1539),n(4747),n(4916),n(4765),n(6992),n(8674),n(8783),n(3948),n(5306),n(9714),n(7042),n(4553),n(561),n(2526),n(1817),n(2165),n(1038),n(8309);var c="Agenda!A3:C26",o=function(e){return e<=9?"0"+e:e};function i(e){var t=[e.getFullYear(),o(e.getMonth()+1),o(e.getDate()),o(e.getHours()),o(e.getMinutes()),o(e.getSeconds())],n=t[1],r=t[2],a=t[3],c=t[4],i=t[5];return"".concat(t[0]).concat(n).concat(r,"T").concat(a).concat(c).concat(i)}function s(e){var t=e.target.querySelectorAll("[id*=startInput]"),a=e.target.querySelectorAll("[id*=endInput]"),o=e.target.querySelectorAll("h2"),s=[];e.preventDefault(),n.e(729).then(n.t.bind(n,3729,23)).then((function(e){var u=e.default;r(t).forEach((function(e,t){var n=e.parentElement.parentElement.parentElement,r=new Date(e.value),c=new Date(e.value),l=a[t].value.toString().replace(/(\d{4})-(\d{2})-(\d{2})/,"$2/$3/$1"),d=new Date(l),f=o[t].innerHTML,p=f.replace(/^(\d\d?):.+$/,"$1"),h=-1!==f.search(/PM$/)?parseInt(p,10)+12:parseInt(p,10);r.setHours(h),c.setHours(h+1),d.setHours(23,59);var v="BEGIN:VCALENDAR\nVERSION:2.0\nCALSCALE:GREGORIAN\nPRODID:https://ccmadison.github.io/ccm-app/\nBEGIN:VEVENT\nUID:".concat(i(r),"-").concat(i(d),"\nSUMMARY:My prayer time - ").concat(f,"\nDESCRIPTION:My prayer time for ").concat(f," (until: ").concat(l,")\nSTATUS:CONFIRMED\nDTSTAMP:").concat(i(r),"Z\nDTSTART;TZID=America/Chicago:").concat(i(r),"\nRRULE:FREQ=DAILY;UNTIL=").concat(i(d),"Z\nDTEND;TZID=America/Chicago:").concat(i(c),"\nEND:VEVENT\nEND:VCALENDAR");n.insertAdjacentHTML("beforeend",'<div class="col-12 text-center">\n  <div class="card card-body">\n    <p class="mb-0">\n      <button type="button" class="btn btn-outline-primary Download">Download Calendar file (.ics)</button> with reminders\n    </p>\n  </div>\n</div>'),n.querySelector(".Download").addEventListener("click",(function(e){u(v,"prayer-reservation_".concat(t+1,".ics"),"text/calendar")})),s.push([f,"TRUE",l])}));var l=document.getElementById("AgendaTable").querySelectorAll("tr"),d=[];r(l).forEach((function(e){var t,n=[],r=e.querySelectorAll("td");t=n,r.forEach((function(e,n){0==n&&t.push(e.innerHTML),1==n&&("Open"==e.innerHTML?t.push("FALSE"):t.push("TRUE")),3==n&&-1!=e.innerHTML.search(/\d\d?\/\d\d?\/\d{4}/)&&t.push(e.innerHTML),3==n&&-1==e.innerHTML.search(/\d\d?\/\d\d?\/\d{4}/)&&t.push("")})),d.push(n)}));var f=d.slice(1);s.forEach((function(e){var t=e[0],n=f.findIndex((function(e){return e[0]==t}));f.splice(n,1,e)}));var p={spreadsheetId:"1UyPFZVN4NIo959qxGCwP6cyKoe9fq5KHD0zE2hyGUi8",range:c,valueInputOption:"USER_ENTERED"},h={range:c,majorDimension:"ROWS",values:f};gapi.client.sheets.spreadsheets.values.update(p,h).then((function(e){var t=document.getElementById("Reserve").querySelector(".card.card-body.bg-light"),r=document.getElementById("reserveSubmit");t.insertAdjacentHTML("afterbegin",'<div class="alert alert-success text-center mb-3" role="alert">\n  <h3 class="text-success">Success!</h3>\n  <p class="text-success mb-0">Your reservation was successful.</p>\n</div>'),f.splice(0,0,[""],["Times","Status","End date of reservation"]),r.disabled=!0;var a={result:{values:f}};n.e(889).then(n.bind(n,4835)).then((function(e){return(0,e.default)(a)}))}),(function(e){console.error("Error updating the spreadsheet: ".concat(e.result.error.message))}))}))}t.default=function(){document.getElementById("Reserve").addEventListener("submit",s,!1)}},1150:function(e){e.exports=Object.is||function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}},4553:function(e,t,n){"use strict";var r=n(2109),a=n(2092).findIndex,c=n(1223),o="findIndex",i=!0;o in[]&&Array(1).findIndex((function(){i=!1})),r({target:"Array",proto:!0,forced:i},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),c(o)},561:function(e,t,n){"use strict";var r=n(2109),a=n(7854),c=n(1400),o=n(9303),i=n(6244),s=n(7908),u=n(5417),l=n(6135),d=n(1194)("splice"),f=a.TypeError,p=Math.max,h=Math.min,v=9007199254740991,g="Maximum allowed length exceeded";r({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,r,a,d,E,m,y=s(this),I=i(y),A=c(e,I),b=arguments.length;if(0===b?n=r=0:1===b?(n=0,r=I-A):(n=b-2,r=h(p(o(t),0),I-A)),I+n-r>v)throw f(g);for(a=u(y,r),d=0;d<r;d++)(E=A+d)in y&&l(a,d,y[E]);if(a.length=r,n<r){for(d=A;d<I-r;d++)m=d+n,(E=d+r)in y?y[m]=y[E]:delete y[m];for(d=I;d>I-r+n;d--)delete y[d-1]}else if(n>r)for(d=I-r;d>A;d--)m=d+n-1,(E=d+r-1)in y?y[m]=y[E]:delete y[m];for(d=0;d<n;d++)y[d+A]=arguments[d+2];return y.length=I-r+n,a}})},9714:function(e,t,n){"use strict";var r=n(1702),a=n(6530).PROPER,c=n(1320),o=n(9670),i=n(7976),s=n(1340),u=n(7293),l=n(7066),d="toString",f=RegExp.prototype,p=f.toString,h=r(l),v=u((function(){return"/a/b"!=p.call({source:"a",flags:"b"})})),g=a&&p.name!=d;(v||g)&&c(RegExp.prototype,d,(function(){var e=o(this),t=s(e.source),n=e.flags;return"/"+t+"/"+s(void 0===n&&i(f,e)&&!("flags"in f)?h(e):n)}),{unsafe:!0})},4765:function(e,t,n){"use strict";var r=n(6916),a=n(7007),c=n(9670),o=n(4488),i=n(1150),s=n(1340),u=n(8173),l=n(7651);a("search",(function(e,t,n){return[function(t){var n=o(this),a=null==t?void 0:u(t,e);return a?r(a,t,n):new RegExp(t)[e](s(n))},function(e){var r=c(this),a=s(e),o=n(t,r,a);if(o.done)return o.value;var u=r.lastIndex;i(u,0)||(r.lastIndex=0);var d=l(r,a);return i(r.lastIndex,u)||(r.lastIndex=u),null===d?-1:d.index}]}))}}]);